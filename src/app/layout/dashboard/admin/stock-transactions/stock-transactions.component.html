<mat-card class="mb-20">
  <mat-card-content>
    <mat-card-title>
      <h3> Stock Transactions</h3>
      <a class="title" href="http://tradetracker.com.pk/" target="_blank">
        <img width="90" src="assets/images/tt2logo.png">

    </a>
    </mat-card-title>
    <br>
    <br>
    <section class="example-section">
        <section class="example-section">
         <!-- <mat-form-field class="example-margin mr-5-IMP">
            <mat-select placeholder="FACTORY" name='FACTORY' [(ngModel)]="selectedFactory" >
              <mat-option [value]="type.id" *ngFor="let type of factories" (click)="getFactoryStock()" >{{type.title}}</mat-option>
            </mat-select>
          </mat-form-field>-->
          <form [formGroup]="form">
          <mat-form-field class="example-margin mr-5-IMP">
            <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker0" formControlName="startDate"  placeholder="Start Date" readonly>
            <mat-datepicker-toggle matSuffix [for]="picker0"></mat-datepicker-toggle>
            <mat-datepicker #picker0></mat-datepicker>
          </mat-form-field>

          <mat-form-field class="example-margin mr-5-IMP">
            <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker1" formControlName="endDate"   placeholder="End Date" readonly>
            <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
            <mat-datepicker #picker1></mat-datepicker>
          </mat-form-field>

         <mat-form-field class="example-margin mr-5-IMP">
            <mat-select placeholder="Transaction Type" name='Transaction Type' formControlName="transferType" >
              <mat-option [value]="type" *ngFor="let type of transferTypes"  (click)="getStockTransactionsData()">{{type}}</mat-option>
            </mat-select>
          </mat-form-field>
          </form>
          <!--
                   <mat-form-field class="example-margin mr-5-IMP">
                     <mat-select placeholder="TOWN" name='TOWN' [(ngModel)]="selectedTown" >
                       <mat-option [value]="type.id" *ngFor="let type of towns" (click)="getTownStock()">{{ type.title }}</mat-option>
                     </mat-select>
                   </mat-form-field>-->
        </section>


        <br>
<!--        <h5 *ngIf="isFactoryStock"> Factory Available Stock</h5>
        <h5 *ngIf="isTerritoryStock"> Territory Available Stock</h5>
        <h5 *ngIf="isTownStock"> Town Available Stock</h5>-->
        <div >
          <table class="table"  >
            <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Type</th>
              <th scope="col">Sender</th>
              <th scope="col">Receiver</th>
              <th scope="col">Send Date</th>
              <th scope="col">Receive Date</th>
              <th scope="col">Status</th>
              <th scope="col">Details</th>
            </tr>
            </thead>
            <tbody >
            <tr  *ngFor="let details of stockTransactionsData; let i = index;"  >
              <td>
                {{details.id}}
              </td>
              <td>
                {{details.transferType}}
              </td>
              <td>{{details.sender}}</td>
              <td>{{details.receiver}}</td>
              <td>{{details.sendDate}}</td>
              <td>{{details.receiveDate}}</td>
              <td>{{details.status}}</td>
              <td>
                <button class="btn btn-primary" (click)="showChildModal(details.id , details.receiveDate , details.status)"><i class="fas fa-bars"></i></button>
              </td>
            </tr>

            </tbody>
          </table>
        </div>
    </section>
  </mat-card-content>
</mat-card>


<div bsModal #TransactionDetailModal="bs-modal" [config]="{backdrop: 'static',keyboard: false}" class="modal fade" tabindex="-1"
     role="dialog" aria-labelledby="dialog-child-name">
  <div class="modal-dialog ">
    <div class="modal-content">
      <div class="modal-header">
        <h4 id="dialog-child-name" class="modal-title pull-left">Transaction Details</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="hideChildModal()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <table class="table" >
          <thead>
          <tr>
            <th scope="col">Brand Name</th>
            <th scope="col">Transferred</th>
            <th scope="col" >Received</th>
          </tr>
          </thead>
          <tbody >
         <!-- <tr  *ngFor="let stock of form.get('transferStock')['controls']; let i = index;" [formGroupName]="i" >-->
         <tr *ngFor =" let stock of availableStock">
          <!--  <td><mat-form-field class="example-margin  mtb-5-IMP" >-->
              <!--<input matInput readonly formControlName="brandName"    name="Brand-Name">-->
           <td class="example-margin  mtb-5-IMP">
              {{stock.brandName}}
           </td>
            <!--</mat-form-field></td>-->
            <td class="example-margin  mtb-5-IMP">
              <!--<mat-form-field class="example-margin  mtb-5-IMP" >-->
               <!-- <input matInput readonly formControlName="stock"   name="Available-Stock">-->
                {{stock.stock}}
              <!--</mat-form-field>-->
            </td>
            <td class="example-margin  mtb-5-IMP">
              <!--<mat-form-field class="example-margin  mtb-5-IMP" >-->
               <!-- <input matInput type="number"  formControlName="receiveQty"   name="Transfer-Quantity">-->
                {{stock.received}}
              <!--</mat-form-field>-->
            </td>
          </tr>

          </tbody>
        </table>

      </div>

      <div class="modal-footer" *ngIf="isReversAble">
        <button class="btn btn-primary" (click)="reverseTransaction()" >
          Make Reverse Transaction
        </button>
      </div>
    </div>
  </div>
</div>
